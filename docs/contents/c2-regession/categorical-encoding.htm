<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:x="urn:schemas-microsoft-com:office:excel"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Excel.Sheet>
<meta name=Generator content="Microsoft Excel 15">
<link rel=File-List href="categorical-encoding.fld/filelist.xml">
<style id="categorical-encoding_9130_Styles">
<!--table
	{mso-displayed-decimal-separator:"\,";
	mso-displayed-thousand-separator:"\.";}
@page
	{mso-footer-data:"&C&\0022Helvetica Neue\,Regular\0022&12&K000000&P";
	margin:.75in .7in .75in .7in;
	mso-header-margin:.3in;
	mso-footer-margin:.3in;}
.font0
	{color:black;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Calibri;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font5
	{color:black;
	font-size:10.0pt;
	font-weight:700;
	font-style:normal;
	text-decoration:none;
	font-family:Calibri;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font6
	{color:#ABB2BF;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Calibri;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font7
	{color:#333333;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font8
	{color:#006B65;
	font-size:10.0pt;
	font-weight:400;
	font-style:italic;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font9
	{color:#ABB2BF;
	font-size:10.0pt;
	font-weight:400;
	font-style:italic;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font10
	{color:#C678DD;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font11
	{color:#98C379;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font12
	{color:#D19A66;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font13
	{color:#333333;
	font-size:10.0pt;
	font-weight:700;
	font-style:normal;
	text-decoration:none;
	font-family:Calibri;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font14
	{color:#ABB2BF;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font15
	{color:#D19A66;
	font-size:10.0pt;
	font-weight:400;
	font-style:italic;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font16
	{color:#C678DD;
	font-size:10.0pt;
	font-weight:400;
	font-style:italic;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font17
	{color:#98C379;
	font-size:10.0pt;
	font-weight:400;
	font-style:italic;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font18
	{color:#365B9C;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font19
	{color:#56B6C2;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font20
	{color:#61AFEF;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font21
	{color:black;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
.font22
	{color:black;
	font-size:10.0pt;
	font-weight:700;
	font-style:normal;
	text-decoration:underline;
	text-underline-style:single;
	font-family:Calibri;
	mso-generic-font-family:auto;
	mso-font-charset:0;}
tr
	{mso-height-source:auto;}
col
	{mso-width-source:auto;}
br
	{mso-data-placement:same-cell;}
.style0
	{text-align:general;
	vertical-align:bottom;
	white-space:nowrap;
	mso-rotate:0;
	color:black;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Calibri;
	mso-generic-font-family:auto;
	mso-font-charset:0;
	mso-style-name:Normal;
	mso-style-id:0;}
td
	{mso-style-parent:style0;
	padding-top:1px;
	padding-right:1px;
	padding-left:1px;
	mso-ignore:padding;
	color:black;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Calibri;
	mso-generic-font-family:auto;
	mso-font-charset:0;
	mso-number-format:General;
	text-align:general;
	vertical-align:bottom;
	border:none;
	mso-background-source:auto;
	mso-pattern:auto;
	mso-protection:locked visible;
	white-space:nowrap;
	mso-rotate:0;}
.xl63
	{mso-style-parent:style0;
	vertical-align:top;
	white-space:normal;}
.xl64
	{mso-style-parent:style0;
	vertical-align:top;
	border:.5pt solid #C8C8C8;
	white-space:normal;}
.xl65
	{mso-style-parent:style0;
	font-size:11.0pt;
	font-weight:700;
	mso-number-format:"\@";
	vertical-align:top;
	border:.5pt solid #C8C8C8;
	background:#F7F7F6;
	mso-pattern:black none;
	white-space:normal;}
.xl66
	{mso-style-parent:style0;
	mso-number-format:"\@";
	vertical-align:top;
	border:.5pt solid #C8C8C8;
	white-space:normal;}
.xl67
	{mso-style-parent:style0;
	color:#333333;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;
	mso-number-format:"\@";
	vertical-align:top;
	border:.5pt solid #C8C8C8;
	white-space:normal;}
.xl68
	{mso-style-parent:style0;
	mso-number-format:"\@";
	vertical-align:top;
	border:.5pt solid #C8C8C8;
	background:#F7F7F6;
	mso-pattern:black none;
	white-space:normal;}
.xl69
	{mso-style-parent:style0;
	color:#333333;
	font-family:Courier;
	mso-generic-font-family:auto;
	mso-font-charset:0;
	mso-number-format:"\@";
	vertical-align:top;
	border:.5pt solid #C8C8C8;
	background:#F7F7F6;
	mso-pattern:black none;
	white-space:normal;}
.xl70
	{mso-style-parent:style0;
	vertical-align:top;
	border:.5pt solid #C8C8C8;
	background:#F7F7F6;
	mso-pattern:black none;
	white-space:normal;}
.xl71
	{mso-style-parent:style0;
	font-size:11.0pt;
	font-weight:700;
	mso-number-format:"\@";
	text-align:center;
	vertical-align:middle;
	border:.5pt solid #C8C8C8;
	white-space:normal;}
-->
</style>
</head>

<body link=blue vlink=fuchsia class=xl63>
<!--[if !excel]>&nbsp;&nbsp;<![endif]-->
<!--The following information was generated by Microsoft Excel's Publish as Web
Page wizard.-->
<!--If the same item is republished from Excel, all information between the DIV
tags will be replaced.-->
<!----------------------------->
<!--START OF OUTPUT FROM EXCEL PUBLISH AS WEB PAGE WIZARD -->
<!----------------------------->

<div id="categorical-encoding_9130" align=center x:publishsource="Excel">

<table border=0 cellpadding=0 cellspacing=0 width=3355 style='border-collapse:
 collapse;table-layout:fixed;width:2516pt'>
 <col class=xl63 width=148 style='mso-width-source:userset;mso-width-alt:5683;
 width:111pt'>
 <col class=xl63 width=285 style='mso-width-source:userset;mso-width-alt:10956;
 width:214pt'>
 <col class=xl63 width=247 style='mso-width-source:userset;mso-width-alt:9472;
 width:185pt'>
 <col class=xl63 width=228 style='mso-width-source:userset;mso-width-alt:8755;
 width:171pt'>
 <col class=xl63 width=299 style='mso-width-source:userset;mso-width-alt:11468;
 width:224pt'>
 <col class=xl63 width=640 style='mso-width-source:userset;mso-width-alt:24576;
 width:480pt'>
 <col class=xl63 width=745 style='mso-width-source:userset;mso-width-alt:28620;
 width:559pt'>
 <col class=xl63 width=763 style='mso-width-source:userset;mso-width-alt:29286;
 width:572pt'>
 <col class=xl63 width=71 style='mso-width-source:userset;mso-width-alt:2713;
 width:53pt'>
 <tr height=20 style='mso-height-source:userset;height:15.0pt'>
  <td colspan=8 height=20 class=xl71 width=3355 style='height:15.0pt;
  width:2516pt'>Categorical Encoding</td>
 </tr>
 <tr height=20 style='mso-height-source:userset;height:15.0pt'>
  <td height=20 class=xl65 width=148 style='height:15.0pt;border-top:none;
  width:111pt'>Encoding Method</td>
  <td class=xl65 width=285 style='border-top:none;border-left:none;width:214pt'>Description</td>
  <td class=xl65 width=247 style='border-top:none;border-left:none;width:185pt'>Advantages</td>
  <td class=xl65 width=228 style='border-top:none;border-left:none;width:171pt'>Disadvantages</td>
  <td class=xl65 width=299 style='border-top:none;border-left:none;width:224pt'>Observations</td>
  <td class=xl65 width=640 style='border-top:none;border-left:none;width:480pt'>Numpy/Pandas</td>
  <td class=xl65 width=745 style='border-top:none;border-left:none;width:559pt'>Scikit-learn</td>
  <td class=xl65 width=763 style='border-top:none;border-left:none;width:572pt'>Feature-Engine</td>
 </tr>
 <tr height=280 style='mso-height-source:userset;height:210.25pt'>
  <td height=280 class=xl66 width=148 style='height:210.25pt;border-top:none;
  width:111pt'>One Hot Encoding</td>
  <td class=xl66 width=285 style='border-top:none;border-left:none;width:214pt'><font
  class="font0">Mã hóa one-hot gồm mã hóa từng biến hạng mục với các biến
  boolean khác (còn được gọi là biến giả) nhận các giá trị 0 hoặc 1, cho biết
  liệu một hạng mục có xuất hiện trong một quan sát hay không.</font><font
  class="font0"><br>
    </font><font class="font0"><br>
    </font><font class="font0">Encoding into K or K-1 binary variable</font></td>
  <td class=xl66 width=247 style='border-top:none;border-left:none;width:185pt'><font
  class="font0">- Dễ thực hiện.</font><font class="font0"><br>
    </font><font class="font0">- Không đưa ra giả định về các hạng mục hoặc
  phân phối của biến hạng mục.</font><font class="font0"><br>
    </font><font class="font0">- Giữ tất cả thông tin của biến hạng mục.</font><font
  class="font0"><br>
    </font><font class="font0">- Thích hợp với mô hình tuyến tính.</font><font
  class="font0"><br>
    </font><font class="font0"><br>
    </font></td>
  <td class=xl66 width=228 style='border-top:none;border-left:none;width:171pt'><font
  class="font0">- Mở rộng không gian đặc trưng.</font><font class="font0"><br>
    </font><font class="font0">- Không thêm thông tin bổ sung trong khi mã hóa.</font><font
  class="font0"><br>
    </font><font class="font0">- Nhiều biến giả có thể giống hệt nhau, đưa
  thông tin dư thừa.</font><font class="font0"><br>
    </font></td>
  <td class=xl66 width=299 style='border-top:none;border-left:none;width:224pt'><font
  class="font0">Phần lớn các thuật toán học máy đều xem xét toàn bộ tập dữ liệu
  trong khi khớp. Do đó, mã hóa các biến hạng mục thành k - 1 biến nhị phân
  sẽ<span style='mso-spacerun:yes'>  </span>tốt hơn vì nó tránh đưa vào thông
  tin dư thừa. <br>
    </font><font class="font5">Ngoại lệ: Mã hóa one-hot thành k biến giả</font><font
  class="font0"> </font><font class="font6"><br>
    </font><font class="font0">Một số trường hợp tốt hơn nên mã hóa các biến
  thành k biến giả:</font><font class="font0"><br>
    </font><font class="font0"><br>
    </font><font class="font0">- khi xây dựng các thuật toán cây</font><font
  class="font0"><br>
    </font><font class="font0">- khi thực hiện lựa chọn đặc trưng bởi các thuật
  toán đệ quy</font><font class="font0"><br>
    </font><font class="font0">- khi muốn xác định mức độ quan trọng của từng
  hạng mục riêng lẻ</font><font class="font0"><br>
    </font></td>
  <td class=xl67 dir=LTR width=640 style='border-top:none;border-left:none;
  width:480pt'><font class="font8"># K Variables: </font><font class="font9"><br>
    </font><font class="font7">tmp </font><font class="font10">=</font><font
  class="font7"> pd.get_dummies(X_train)<br>
    </font><font class="font7"> <br>
    </font><font class="font8"># K-1 Variables: </font><font class="font9"><br>
    </font><font class="font7">tmp </font><font class="font10">=</font><font
  class="font7"> pd.get_dummies(X_train[</font><font class="font11">'sex'</font><font
  class="font7">], </font><font class="font12">drop_first</font><font
  class="font10">=</font><font class="font12">True</font><font class="font7">)<br>
    </font><font class="font13"><br>
    </font></td>
  <td class=xl67 dir=LTR width=745 style='border-top:none;border-left:none;
  width:559pt'><font class="font10">from</font><font class="font7">
  sklearn.preprocessing </font><font class="font10">import</font><font
  class="font7"> OneHotEncoder<br>
    </font><font class="font7"><br>
    </font><font class="font7">encoder </font><font class="font10">=</font><font
  class="font7"> OneHotEncoder(</font><font class="font12">categories</font><font
  class="font10">=</font><font class="font11">'auto'</font><font class="font7">,<br>
    </font><font class="font14"><span
  style='mso-spacerun:yes'>                       </span></font><font
  class="font12">drop</font><font class="font10">=</font><font class="font11">'first'</font><font
  class="font14">, </font><font class="font8"># trả về k-1, sử dụng drop=false
  để trả về k biến giả</font><font class="font14"><br>
    </font><font class="font7"><span
  style='mso-spacerun:yes'>                       </span></font><font
  class="font12">sparse</font><font class="font10">=</font><font class="font12">False</font><font
  class="font7">,<br>
    </font><font class="font8"><span
  style='mso-spacerun:yes'>                       </span></font><font
  class="font15">handle_unknown</font><font class="font16">=</font><font
  class="font17">'error'</font><font class="font8">) # giúp xử lý nhãn
  hiếm<br>
    </font><font class="font7"><br>
    </font><font class="font7">encoder.fit(X_train.fillna(</font><font
  class="font11">'Missing'</font><font class="font7">))<br>
    </font><font class="font8"># quan sát các hạng mục đã tìm hiểu </font><font
  class="font14"><br>
    </font><font class="font7">encoder.categories_ # MỚI: trong bản phát hành
  mới nhất của Scikit-learn<br>
    </font><font class="font8"># chúng ta có thể truy xuất tên các đặc trưng
  như sau:</font><font class="font14"><br>
    </font><font class="font7">encoder.get_feature_names()<br>
    </font><font class="font7"><br>
    </font></td>
  <td class=xl66 width=763 style='border-top:none;border-left:none;width:572pt'><font
  class="font10">from</font><font class="font7"> feature_engine.encoding </font><font
  class="font10">import</font><font class="font7"> OneHotEncoder<br>
    </font><font class="font7"><br>
    </font><font class="font7">ohe_enc </font><font class="font10">=</font><font
  class="font7"> OneHotEncoder(<br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font7">top_categories</font><font class="font10">=</font><font
  class="font7">None</font><font class="font14">,<br>
    </font><font class="font9"><span style='mso-spacerun:yes'>    </span></font><font
  class="font15">variables</font><font class="font16">=</font><font
  class="font9">[</font><font class="font17">'sex'</font><font class="font9">, </font><font
  class="font17">'embarked'</font><font class="font9">],<span
  style='mso-spacerun:yes'>  </span></font><font class="font8"># có thể chọn
  biến để mã hóa</font><font class="font9"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">drop_last</font><font class="font10">=</font><font
  class="font12">True</font><font class="font14">)<span
  style='mso-spacerun:yes'>  </span></font><font class="font8"># trả về k-1,
  false trả về k</font><font class="font14"><br>
    </font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7">ohe_enc.fit(X_train.fillna(</font><font
  class="font11">'Missing'</font><font class="font7">))<br>
    </font><font class="font7">tmp </font><font class="font10">=</font><font
  class="font7"> ohe_enc.transform(X_train.fillna(</font><font class="font11">'Missing'</font><font
  class="font7">))<br>
    </font><font class="font18"><br>
    </font></td>
 </tr>
 <tr height=261 style='mso-height-source:userset;height:196.5pt'>
  <td height=261 class=xl68 width=148 style='height:196.5pt;border-top:none;
  width:111pt'>One Hot Encoding of Frequent/Top Categories</td>
  <td class=xl68 width=285 style='border-top:none;border-left:none;width:214pt'>Performing
  one hot encoding, only considering the most frequent categories</td>
  <td class=xl68 width=247 style='border-top:none;border-left:none;width:185pt'><font
  class="font0">- Dễ triển khai.</font><font class="font0"><br>
    </font><font class="font0">- Không yêu cầu nhiều giờ thăm dò biến.</font><font
  class="font0"><br>
    </font><font class="font0">- Không mở rộng nhiều không gian đặc trưng.</font><font
  class="font0"><br>
    </font><font class="font0">- Thích hợp với mô hình tuyến tính.</font><font
  class="font0"><br>
    </font></td>
  <td class=xl68 width=228 style='border-top:none;border-left:none;width:171pt'><font
  class="font0">- Không thêm bất kỳ thông tin nào có thể khiến biến có tính dự
  đoán hơn.</font><font class="font0"><br>
    </font><font class="font0">- Không giữ thông tin của các nhãn bị bỏ qua.</font><font
  class="font0"><br>
    </font></td>
  <td class=xl68 width=299 style='border-top:none;border-left:none;width:224pt'><font
  class="font0">Số lượng các biến hàng đầu được đặt tùy ý. Trong cuộc thi KDD,
  các tác giả đã chọn 10, nhưng cũng có thể là 15 hoặc 5. Con số này có thể
  được chọn tùy ý hoặc bắt nguồn từ việc thăm dò dữ liệu.</font><font
  class="font0"><br>
    </font></td>
  <td class=xl69 dir=LTR width=640 style='border-top:none;border-left:none;
  width:480pt'><font class="font10">def</font><font class="font14"> </font><font
  class="font7">calculate_top_categories</font><font class="font14">(</font><font
  class="font12">df</font><font class="font14">,</font><font class="font12">
  variable</font><font class="font14">,</font><font class="font12"> how_many</font><font
  class="font10">=</font><font class="font12">10</font><font class="font14">):</font><font
  class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font7">return</font><font class="font14"> [</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>        </span>x </font><font
  class="font10">for</font><font class="font7"> x </font><font class="font10">in</font><font
  class="font7"> df[variable].value_counts().sort_values(</font><font
  class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>           
  </span></font><font class="font12">ascending</font><font class="font10">=</font><font
  class="font12">False</font><font class="font7">).head(how_many).index</font><font
  class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span>]</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font10">def</font><font class="font14"> </font><font
  class="font7">one_hot_encode</font><font class="font14">(</font><font
  class="font12">train</font><font class="font14">,</font><font class="font12">
  test</font><font class="font14">,</font><font class="font12"> variable</font><font
  class="font14">,</font><font class="font12"> top_x_labels</font><font
  class="font14">):</font><font class="font14"><br>
    </font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font10">for</font><font class="font7"> label </font><font
  class="font10">in</font><font class="font7"> top_x_labels:</font><font
  class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>       
  </span>train[variable </font><font class="font10">+</font><font class="font7">
  </font><font class="font11">'_'</font><font class="font7"> </font><font
  class="font10">+</font><font class="font7"> label] </font><font class="font10">=</font><font
  class="font7"> np.where(</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>           
  </span>train[variable] </font><font class="font10">==</font><font
  class="font7"> label, </font><font class="font12">1</font><font class="font7">,
  </font><font class="font12">0</font><font class="font7">)</font><font
  class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>        </span></font><font
  class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>       
  </span>test[variable </font><font class="font10">+</font><font class="font7">
  </font><font class="font11">'_'</font><font class="font7"> </font><font
  class="font10">+</font><font class="font7"> label] </font><font class="font10">=</font><font
  class="font7"> np.where(</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>           
  </span>test[variable] </font><font class="font10">==</font><font class="font7">
  label,</font><font class="font12">1</font><font class="font7">, </font><font
  class="font12">0</font><font class="font7">)</font><font class="font7"><br>
    </font></td>
  <td class=xl68 width=745 style='border-top:none;border-left:none;width:559pt'>N/A</td>
  <td class=xl69 dir=LTR width=763 style='border-top:none;border-left:none;
  width:572pt'><font class="font7">ohe_enc </font><font class="font10">=</font><font
  class="font7"> OneHotEncoder(</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">top_categories</font><font class="font10">=</font><font
  class="font12">10</font><font class="font14">,<span
  style='mso-spacerun:yes'>  </span></font><font class="font8"># có thể thay
  đổi giá trị này để chọn nhiều hoặc ít biến hơn</font><font class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># có thể lựa chọn biến để mã hóa</font><font class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">variables</font><font class="font10">=</font><font
  class="font14">[</font><font class="font7">'Neighborhood'</font><font
  class="font14">, </font><font class="font7">'Exterior1st'</font><font
  class="font14">, </font><font class="font7">'Exterior2nd'</font><font
  class="font14">],</font><font class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font7">drop_last</font><font class="font10">=</font><font class="font7">False</font><font
  class="font14">)</font><font class="font14"><br>
    </font><font class="font7"><br>
    </font><font class="font7">ohe_enc.fit(X_train)</font><font class="font7"><br>
    </font></td>
 </tr>
 <tr height=277 style='mso-height-source:userset;height:208.5pt'>
  <td height=277 class=xl66 width=148 style='height:208.5pt;border-top:none;
  width:111pt'>Integer Encoding</td>
  <td class=xl66 width=285 style='border-top:none;border-left:none;width:214pt'><font
  class="font0">Mã hóa số nguyên gồm việc thay thế các hạng mục bằng các chữ số
  từ 1 đến n (hoặc 0 đến n-1, tùy thuộc vào cách triển khai), trong đó n là số
  hạng mục riêng biệt của biến.</font><font class="font0"><br>
    </font><font class="font0"><br>
    </font><font class="font0">Các con số được chỉ định tùy ý. Phương pháp mã
  hóa này cho phép xác định đối chuẩn (benchmarking) nhanh chóng của các mô
  hình học máy.</font><font class="font0"><br>
    </font></td>
  <td class=xl66 width=247 style='border-top:none;border-left:none;width:185pt'><font
  class="font0">- Dễ triển khai.</font><font class="font0"><br>
    </font><font class="font0">- Không mở rộng không gian đặc trưng.</font><font
  class="font0"><br>
    </font></td>
  <td class=xl66 width=228 style='border-top:none;border-left:none;width:171pt'><font
  class="font0">- Không thu thập thông tin về các nhãn hạng mục.</font><font
  class="font0"><br>
    </font><font class="font0">- Không thích hợp với mô hình tuyến tính.</font><font
  class="font0"><br>
    </font></td>
  <td class=xl66 width=299 style='border-top:none;border-left:none;width:224pt'><font
  class="font0">Mã hóa số nguyên thích hợp hơn với các phương pháp phi tuyến
  tính có khả năng điều hướng thông qua các chữ số được chỉ định tùy ý để tìm
  những mẫu liên kết chúng với mục tiêu.</font><font class="font0"><br>
    </font></td>
  <td class=xl67 dir=LTR width=640 style='border-top:none;border-left:none;
  width:480pt'><font class="font10">def</font><font class="font14"> </font><font
  class="font7">find_category_mappings</font><font class="font14">(</font><font
  class="font12">df</font><font class="font14">,</font><font class="font12">
  variable</font><font class="font14">):</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font10">return</font><font class="font7"> {k: i </font><font
  class="font10">for</font><font class="font7"> i, k </font><font class="font10">in</font><font
  class="font7"> </font><font class="font19">enumerate</font><font class="font7">(df[variable].unique(),
  </font><font class="font12">0</font><font class="font7">)}</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font10">def</font><font class="font14"> </font><font
  class="font20">integer_encode</font><font class="font14">(</font><font
  class="font7">train</font><font class="font14">,</font><font class="font7">
  test</font><font class="font14">,</font><font class="font7"> variable</font><font
  class="font14">,</font><font class="font7"> ordinal_mapping</font><font
  class="font14">):</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>train[variable] </font><font class="font10">=</font><font class="font7">
  X_train[variable].map(ordinal_mapping)</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>test[variable] </font><font class="font10">=</font><font class="font7">
  X_test[variable].map(ordinal_mapping)</font><font class="font7"><br>
    </font></td>
  <td class=xl66 width=745 style='border-top:none;border-left:none;width:559pt'><font
  class="font10">from</font><font class="font7"> sklearn.preprocessing </font><font
  class="font10">import</font><font class="font7"> LabelEncoder</font><font
  class="font7"><br>
    </font><font class="font7"> le </font><font class="font10">=</font><font
  class="font7"> LabelEncoder()</font><font class="font7"><br>
    </font><font class="font7">le.fit(X_train[</font><font class="font11">'Neighborhood'</font><font
  class="font7">])</font><font class="font7"><br>
    </font><font class="font8"> # </font><font class="font8">Không may,
  LabelEncoder hoạt động với một biến tại thời điểm đó. Tuy nhiên, có một cách
  tự động điều này cho tất cả các biến hạng mục</font><font class="font8"><br>
    </font><font class="font8"> </font><font class="font21">d =
  defaultdict(LabelEncoder)</font><font class="font8">  # mã hóa biến</font><font
  class="font8"><br>
    </font><font class="font7">train_transformed </font><font class="font10">=</font><font
  class="font7"> X_train.apply(</font><font class="font10">lambda</font><font
  class="font7"> </font><font class="font12">x</font><font class="font7">:
  d[x.name].fit_transform(x))</font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font8"># Sử dụng dictionary để mã hóa dữ liệu tương lai</font><font
  class="font14"><br>
    </font><font class="font7">test_transformed </font><font class="font10">=</font><font
  class="font7"> X_test.apply(</font><font class="font10">lambda</font><font
  class="font7"> </font><font class="font12">x</font><font class="font7">:
  d[x.name].transform(x))</font><font class="font7"><br>
    </font><font class="font7"><br>
    </font></td>
  <td class=xl66 width=763 style='border-top:none;border-left:none;width:572pt'><font
  class="font7">ordinal_enc </font><font class="font10">=</font><font
  class="font7"> OrdinalEncoder(</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font7">encoding_method</font><font class="font10">=</font><font
  class="font11">'arbitrary'</font><font class="font14">,</font><font
  class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">variables</font><font class="font10">=</font><font
  class="font14">[</font><font class="font7">'Neighborhood'</font><font
  class="font14">, </font><font class="font7">'Exterior1st'</font><font
  class="font14">, </font><font class="font7">'Exterior2nd'</font><font
  class="font14">])</font><font class="font14"><br>
    </font><font class="font7"><br>
    </font><font class="font7">ordinal_enc.fit(X_train)</font><font
  class="font7"><br>
    </font></td>
 </tr>
 <tr height=211 style='mso-height-source:userset;height:158.25pt'>
  <td height=211 class=xl68 width=148 style='height:158.25pt;border-top:none;
  width:111pt'>Count or frequency encoding</td>
  <td class=xl68 width=285 style='border-top:none;border-left:none;width:214pt'><font
  class="font0">Trong mã hóa đếm, chúng ta thay thế các hạng mục bằng số lượng
  quan sát hiển thị hạng mục đó trong tập dữ liệu. Tương tự, chúng ta có thể
  thay thế hạng mục bằng tần số - hoặc tỷ lệ phần trăm - của các quan sát trong
  tập dữ liệu. Nghĩa là, nếu có 10 trong số 100 quan sát hiển thị blue thì
  chúng ta sẽ thay thế blue bằng 10 nếu thực hiện mã hóa đếm hoặc 0.1 nếu thay
  thế bằng tần số.</font><font class="font0"><br>
    </font></td>
  <td class=xl68 width=247 style='border-top:none;border-left:none;width:185pt'><font
  class="font0">- Đơn giản.</font><font class="font0"><br>
    </font><font class="font0">- Không mở rộng không gian đặc trưng.</font><font
  class="font0"><br>
    </font></td>
  <td class=xl68 width=228 style='border-top:none;border-left:none;width:171pt'><font
  class="font0">- Nếu 2 hạng mục khác nhau có cùng số lần xuất hiện trong tập
  dữ liệu, tức là chúng có số lượng quan sát giống nhau thì sẽ được thay thế
  bằng cùng một số: có thể mất thông tin có giá trị.</font><font class="font0"><br>
    </font><font class="font0"><br>
    </font><font class="font0">Ví dụ: nếu có 10 quan sát cho hạng mục blue và
  10 quan sát cho hạng mục red, cả hai sẽ được thay thế bằng 10 nên sau khi mã
  hóa sẽ xuất hiện cùng một thứ.</font><font class="font0"><br>
    </font><font class="font0"><br>
    </font></td>
  <td class=xl70 width=299 style='border-top:none;border-left:none;width:224pt'>&nbsp;</td>
  <td class=xl68 width=640 style='border-top:none;border-left:none;width:480pt'><font
  class="font10">def</font><font class="font14"> </font><font class="font7">find_count_category_mapping</font><font
  class="font14">(</font><font class="font12">df</font><font class="font14">,</font><font
  class="font12"> variable</font><font class="font14">):</font><font
  class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font10">return</font><font class="font7">
  df[variable].value_counts().to_dict()</font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font10">def</font><font class="font14"> </font><font
  class="font7">find_frequence_category_mapping</font><font class="font14">(</font><font
  class="font12">df</font><font class="font14">,</font><font class="font12">
  variable</font><font class="font14">):</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font10">return</font><font class="font7"> (df[variable].value_counts()
  </font><font class="font10">/</font><font class="font7"> </font><font
  class="font19">len</font><font class="font7">(df[variable])).to_dict()</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font10">def</font><font class="font14"> </font><font
  class="font7">count_frequence_encode</font><font class="font14">(</font><font
  class="font12">train</font><font class="font14">,</font><font class="font12">
  test</font><font class="font14">,</font><font class="font12"> variable</font><font
  class="font14">,</font><font class="font12"> mapping</font><font
  class="font14">):</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>train[variable] </font><font class="font10">=</font><font class="font7">
  train[variable].map(mapping)</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>test[variable] </font><font class="font10">=</font><font class="font7">
  test[variable].map(mapping)</font><font class="font7"><br>
    </font></td>
  <td class=xl68 width=745 style='border-top:none;border-left:none;width:559pt'>NA</td>
  <td class=xl68 width=763 style='border-top:none;border-left:none;width:572pt'><font
  class="font10">from</font><font class="font7"> feature_engine.encoding </font><font
  class="font10">import</font><font class="font7"> CountFrequencyEncoder</font><font
  class="font7"><br>
    </font><font class="font7">  count_enc </font><font class="font10">=</font><font
  class="font7"> CountFrequencyEncoder(</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">encoding_method</font><font class="font10">=</font><font
  class="font11">'count'</font><font class="font14">, </font><font class="font8">#
  để thực hiện tần số ==&gt; encoding_method='frequency'</font><font
  class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">variables</font><font class="font10">=</font><font
  class="font14">[</font><font class="font7">'Neighborhood'</font><font
  class="font14">, </font><font class="font7">'Exterior1st'</font><font
  class="font14">, </font><font class="font7">'Exterior2nd'</font><font
  class="font14">])</font><font class="font14"><br>
    </font><font class="font7"><br>
    </font><font class="font7">count_enc.fit(X_train)</font><font class="font7"><br>
    </font></td>
 </tr>
 <tr height=367 style='mso-height-source:userset;height:275.75pt'>
  <td height=367 class=xl66 width=148 style='height:275.75pt;border-top:none;
  width:111pt'>Target guided encodings - Ordered ordinal encoding</td>
  <td class=xl66 width=285 style='border-top:none;border-left:none;width:214pt'><font
  class="font0">Sắp xếp các hạng mục theo mục tiêu là gán một số cho hạng mục
  từ 1 đến k, trong đó k là số hạng mục riêng biệt trong biến, nhưng việc đánh
  số này được báo bằng giá trị </font><font class="font5">mean</font><font
  class="font0"> của </font><font class="font5">mục tiêu</font><font
  class="font0"> cho từng hạng mục.</font><font class="font0"><br>
    </font><font class="font0"> </font><font class="font0">Ví dụ, chúng ta có
  biến city với các giá trị London, Manchester và Bristol; nếu tỷ lệ mặc định
  là 30% ở London, 20% ở Bristol và 10% ở Manchester thì chúng ta thay London
  bằng 1, Bristol bằng 2 và Manchester bằng 3.</font><font class="font0"><br>
    </font></td>
  <td class=xl66 width=247 style='border-top:none;border-left:none;width:185pt'><font
  class="font0">- Nắm bắt thông tin trong hạng mục nên tạo ra nhiều đặc trưng
  dự đoán hơn.</font><font class="font0"><br>
    </font><font class="font0">- Tạo mối quan hệ đơn điệu giữa biến và mục tiêu
  để phù hợp với mô hình tuyến tính.</font><font class="font0"><br>
    </font><font class="font0">- Không mở rộng không gian đặc trưng.</font><font
  class="font0"><br>
    </font><font class="font0"><br>
    </font><font class="font0"><br>
    </font></td>
  <td class=xl66 width=228 style='border-top:none;border-left:none;width:171pt'><font
  class="font0">- Dễ dẫn tới overfitting.</font><font class="font0"><br>
    </font><font class="font0">- Khó kiểm định chéo với các thư viện hiện tại.</font><font
  class="font0"><br>
    </font></td>
  <td class=xl66 width=299 style='border-top:none;border-left:none;width:224pt'><font
  class="font22">Note:</font><font class="font0"> Mối quan hệ đơn điệu là mối
  quan hệ thực hiện một trong những điều sau: </font><font class="font0"><br>
    </font><font class="font0">- (1) khi giá trị của một biến tăng lên thì giá
  trị của biến kia cũng vậy; hoặc</font><font class="font0"><br>
    </font><font class="font0">- (2) khi giá trị của một biến tăng, giá trị của
  biến kia lại giảm.</font><font class="font0"><br>
    </font><font class="font0"><br>
    </font><font class="font0">Trong trường hợp này, khi giá trị của biến độc
  lập (yếu tố dự báo) tăng lên, thì mục tiêu cũng vậy; hoặc ngược lại, khi giá
  trị của biến tăng lên thì giá trị mục tiêu lại giảm.</font></td>
  <td class=xl66 width=640 style='border-top:none;border-left:none;width:480pt'><font
  class="font10">def</font><font class="font14"> </font><font class="font7">find_category_mappings</font><font
  class="font14">(</font><font class="font12">df</font><font class="font14">,</font><font
  class="font12"> variable</font><font class="font14">,</font><font
  class="font12"> target</font><font class="font14">):</font><font
  class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># trước tiên tạo một list đã sắp xếp với các nhãn</font><font
  class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>ordered_labels </font><font class="font10">=</font><font class="font7">
  df.groupby([variable</font><font class="font7"><br>
    </font><font class="font7"><span
  style='mso-spacerun:yes'>                      
  </span>])[target].mean().sort_values().index.tolist()</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># trả về dictionary với các mapping</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font10">return</font><font class="font7"> {k: i </font><font
  class="font10">for</font><font class="font7"> i, k </font><font class="font10">in</font><font
  class="font7"> </font><font class="font19">enumerate</font><font class="font7">(ordered_labels,
  </font><font class="font12">0</font><font class="font7">)}</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font10">def</font><font class="font14"> </font><font
  class="font20">integer_encode</font><font class="font14">(</font><font
  class="font7">train</font><font class="font14">,</font><font class="font7">
  test</font><font class="font14">,</font><font class="font7"> variable</font><font
  class="font14">,</font><font class="font7"> ordinal_mapping</font><font
  class="font14">):</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>train[variable] </font><font class="font10">=</font><font class="font7">
  train[variable].map(ordinal_mapping)</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>test[variable] </font><font class="font10">=</font><font class="font7">
  test[variable].map(ordinal_mapping)</font><font class="font7"><br>
    </font></td>
  <td class=xl66 width=745 style='border-top:none;border-left:none;width:559pt'>NA</td>
  <td class=xl66 width=763 style='border-top:none;border-left:none;width:572pt'><font
  class="font10">from</font><font class="font7"> feature_engine.encoding </font><font
  class="font10">import</font><font class="font7"> OrdinalEncoder</font><font
  class="font7"><br>
    </font><font class="font7"> ordinal_enc </font><font class="font10">=</font><font
  class="font7"> OrdinalEncoder(</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># LƯU Ý rằng chúng ta chỉ ra ordered trong encoding_method, nếu
  không thì nó sẽ gán số bất kỳ </font><font class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font7">encoding_method</font><font class="font10">=</font><font
  class="font11">'ordered'</font><font class="font14">,</font><font
  class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">variables</font><font class="font10">=</font><font
  class="font14">[</font><font class="font7">'Neighborhood'</font><font
  class="font14">, </font><font class="font7">'Exterior1st'</font><font
  class="font14">, </font><font class="font7">'Exterior2nd'</font><font
  class="font14">])</font><font class="font14"><br>
    </font><font class="font14"> </font><font class="font7">ordinal_enc.fit(X_train,
  y_train)</font><font class="font7"><br>
    </font><font class="font7">X_train </font><font class="font10">=</font><font
  class="font7"> ordinal_enc.transform(X_train)</font><font class="font7"><br>
    </font><font class="font7">X_test </font><font class="font10">=</font><font
  class="font7"> ordinal_enc.transform(X_test)</font><font class="font7"><br>
    </font></td>
 </tr>
 <tr height=159 style='mso-height-source:userset;height:119.25pt'>
  <td height=159 class=xl68 width=148 style='height:119.25pt;border-top:none;
  width:111pt'>Target guided encodings - Mean encoding</td>
  <td class=xl68 width=285 style='border-top:none;border-left:none;width:214pt'><font
  class="font0">Mã hóa trung bình là thay thế hạng mục theo gia trị mục tiêu
  trung bình cho hạng mục đó. Ví dụ: chúng ta có biến city với các hạng mục
  London, Manchester và Bristol; nếu chúng ta muốn dự đoán tỷ lệ mặc định, nếu
  tỷ lệ mặc định cho London là 30% thì thay London bằng 0.3, nếu tỷ lệ mặc định
  cho Manchester là 20% thì thay Manchester bằng 0.2,....</font><font
  class="font0"><br>
    </font></td>
  <td class=xl68 width=247 style='border-top:none;border-left:none;width:185pt'>Same
  as Ordered Ordinal Encoding</td>
  <td class=xl68 width=228 style='border-top:none;border-left:none;width:171pt'>Same
  as Ordered Ordinal Encoding</td>
  <td class=xl68 width=299 style='border-top:none;border-left:none;width:224pt'>Same
  as Ordered Ordinal Encoding</td>
  <td class=xl68 width=640 style='border-top:none;border-left:none;width:480pt'><font
  class="font10">def</font><font class="font14"> </font><font class="font7">find_category_mappings</font><font
  class="font14">(</font><font class="font12">df</font><font class="font14">,</font><font
  class="font12"> variable</font><font class="font14">,</font><font
  class="font12"> target</font><font class="font14">):</font><font
  class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font10">return</font><font class="font7">
  df.groupby([variable])[target].mean().to_dict()</font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font10">def</font><font class="font14"> </font><font
  class="font20">integer_encode</font><font class="font14">(</font><font
  class="font7">train</font><font class="font14">,</font><font class="font7">
  test</font><font class="font14">,</font><font class="font7"> variable</font><font
  class="font14">,</font><font class="font7"> ordinal_mapping</font><font
  class="font14">):</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>train[variable] </font><font class="font10">=</font><font class="font7">
  train[variable].map(ordinal_mapping)</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>test[variable] </font><font class="font10">=</font><font class="font7">
  test[variable].map(ordinal_mapping)</font><font class="font7"><br>
    </font></td>
  <td class=xl68 width=745 style='border-top:none;border-left:none;width:559pt'>NA</td>
  <td class=xl68 width=763 style='border-top:none;border-left:none;width:572pt'><font
  class="font10">from</font><font class="font7"> feature_engine.encoding </font><font
  class="font10">import</font><font class="font7"> MeanEncoder</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7">mean_enc </font><font class="font10">=</font><font
  class="font7"> MeanEncoder(</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">variables</font><font class="font10">=</font><font
  class="font14">[</font><font class="font7">'cabin'</font><font class="font14">,
  </font><font class="font7">'sex'</font><font class="font14">, </font><font
  class="font7">'embarked'</font><font class="font14">])</font><font
  class="font14"><br>
    </font><font class="font7">mean_enc.fit(X_train, y_train)</font><font
  class="font7"><br>
    </font></td>
 </tr>
 <tr height=160 style='mso-height-source:userset;height:120.0pt'>
  <td height=160 class=xl66 width=148 style='height:120.0pt;border-top:none;
  width:111pt'>Target guided encodings - Probability Ratio Encoding</td>
  <td class=xl66 width=285 style='border-top:none;border-left:none;width:214pt'><font
  class="font0">Mã hóa này chỉ thích hợp với các bài toán phân loại có biến nhị
  phân.</font><font class="font0"><br>
    </font><font class="font0"><br>
    </font><font class="font0">Với từng hạng mục, chúng ta tính mean của
  target=1 là xác suất của mục tiêu là 1 ( P(1) ), và xác suất của target=0 (
  P(0) ). Sau đó, chúng ta tính tỷ lệ P(1)/P(0) và thay thế các hạng mục bằng
  tỷ lệ đó.</font><font class="font0"><br>
    </font></td>
  <td class=xl66 width=247 style='border-top:none;border-left:none;width:185pt'>Same
  as Ordered Ordinal Encoding</td>
  <td class=xl66 width=228 style='border-top:none;border-left:none;width:171pt'>Same
  as Ordered Ordinal Encoding</td>
  <td class=xl66 width=299 style='border-top:none;border-left:none;width:224pt'>Same
  as Ordered Ordinal Encoding</td>
  <td class=xl66 width=640 style='border-top:none;border-left:none;width:480pt'><font
  class="font10">def</font><font class="font14"> </font><font class="font7">find_category_mappings</font><font
  class="font14">(</font><font class="font12">df</font><font class="font14">,</font><font
  class="font12"> variable</font><font class="font14">,</font><font
  class="font12"> target</font><font class="font14">):</font><font
  class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span>tmp </font><font
  class="font10">=</font><font class="font7">
  pd.DataFrame(df.groupby([variable])[target].mean())</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span>tmp[</font><font
  class="font11">'non-target'</font><font class="font7">] </font><font
  class="font10">=</font><font class="font7"> </font><font class="font12">1</font><font
  class="font7"> </font><font class="font10">-</font><font class="font7">
  tmp[target]</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span>tmp[</font><font
  class="font11">'ratio'</font><font class="font7">] </font><font class="font10">=</font><font
  class="font7"> tmp[target] </font><font class="font10">/</font><font
  class="font7"> tmp[</font><font class="font11">'non-target'</font><font
  class="font7">]</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font10">return</font><font class="font7"> tmp[</font><font
  class="font11">'ratio'</font><font class="font7">].to_dict()</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font10">def</font><font class="font14"> </font><font
  class="font20">integer_encode</font><font class="font14">(</font><font
  class="font7">train</font><font class="font14">,</font><font class="font7">
  test</font><font class="font14">,</font><font class="font7"> variable</font><font
  class="font14">,</font><font class="font7"> ordinal_mapping</font><font
  class="font14">):</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>train[variable] </font><font class="font10">=</font><font class="font7">
  train[variable].map(ordinal_mapping)</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>test[variable] </font><font class="font10">=</font><font class="font7">
  test[variable].map(ordinal_mapping)</font><font class="font7"><br>
    </font></td>
  <td class=xl66 width=745 style='border-top:none;border-left:none;width:559pt'>NA</td>
  <td class=xl66 width=763 style='border-top:none;border-left:none;width:572pt'><font
  class="font10">from</font><font class="font7"> feature_engine.encoding </font><font
  class="font10">import</font><font class="font7"> PRatioEncoder</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7">ratio_enc </font><font class="font10">=</font><font
  class="font7"> PRatioEncoder(</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font7">encoding_method</font><font class="font14"> </font><font
  class="font10">=</font><font class="font14"> </font><font class="font11">'ratio'</font><font
  class="font14">,</font><font class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">variables</font><font class="font10">=</font><font
  class="font14">[</font><font class="font7">'cabin'</font><font class="font14">,
  </font><font class="font7">'sex'</font><font class="font14">, </font><font
  class="font7">'embarked'</font><font class="font14">])</font><font
  class="font14"><br>
    </font><font class="font7">ratio_enc.fit(X_train, y_train)</font><font
  class="font7"><br>
    </font><font class="font7">ratio_enc.encoder_dict_</font></td>
 </tr>
 <tr height=421 style='mso-height-source:userset;height:316.5pt'>
  <td height=421 class=xl68 width=148 style='height:316.5pt;border-top:none;
  width:111pt'>Target guided encodings - Weight of evidence</td>
  <td class=xl68 width=285 style='border-top:none;border-left:none;width:214pt'><font
  class="font0">WoE = ln ( Distribution of Goods / Distribution of bads )<br>
    </font><font class="font0">WoE = ln ( p(1) / p(0) )<br>
    </font><font class="font22">Note:</font><font class="font0"> WoE is well
  suited for Logistic Regression</font></td>
  <td class=xl68 width=247 style='border-top:none;border-left:none;width:185pt'>Same
  as Ordered Ordinal Encoding</td>
  <td class=xl68 width=228 style='border-top:none;border-left:none;width:171pt'>Same
  as Ordered Ordinal Encoding</td>
  <td class=xl68 width=299 style='border-top:none;border-left:none;width:224pt'>Same
  as Ordered Ordinal Encoding</td>
  <td class=xl68 width=640 style='border-top:none;border-left:none;width:480pt'><font
  class="font10">def</font><font class="font14"> </font><font class="font7">find_category_mappings</font><font
  class="font14">(</font><font class="font12">df</font><font class="font14">,</font><font
  class="font12"> variable</font><font class="font14">,</font><font
  class="font12"> target</font><font class="font14">):</font><font
  class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># sao chép dataframe ban đầu để không tình cờ</font><font
  class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># sửa nó</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span>tmp </font><font
  class="font10">=</font><font class="font7"> df.copy()</font><font
  class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># tổng class dương</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>total_pos </font><font class="font10">=</font><font class="font7">
  df[target].sum()</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># tổng class âm</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>total_neg </font><font class="font10">=</font><font class="font7"> </font><font
  class="font19">len</font><font class="font7">(df[target]) </font><font
  class="font10">-</font><font class="font7"> df[target].sum()</font><font
  class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># non-target</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span>tmp[</font><font
  class="font11">'non-target'</font><font class="font7">] </font><font
  class="font10">=</font><font class="font7"> </font><font class="font12">1</font><font
  class="font7"> </font><font class="font10">-</font><font class="font7">
  tmp[target]</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># % class dương mỗi hạng mục so với tổng class dương</font><font
  class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>pos_perc </font><font class="font10">=</font><font class="font7">
  tmp.groupby([variable])[target].sum() </font><font class="font10">/</font><font
  class="font7"> total_pos</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># % class âm mỗi hạng mục so với tổng class âm</font><font
  class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>neg_perc </font><font class="font10">=</font><font class="font7">
  tmp.groupby([variable])[</font><font class="font11">'non-target'</font><font
  class="font7">].sum() </font><font class="font10">/</font><font class="font7">
  total_neg</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># hãy nối</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>prob_tmp </font><font class="font10">=</font><font class="font7">
  pd.concat([pos_perc, neg_perc], </font><font class="font12">axis</font><font
  class="font10">=</font><font class="font12">1</font><font class="font7">)</font><font
  class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># tính WoE</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>prob_tmp[</font><font class="font11">'woe'</font><font class="font7">]
  </font><font class="font10">=</font><font class="font7">
  np.log(prob_tmp[target]</font><font class="font10">/</font><font class="font7">prob_tmp[</font><font
  class="font11">'non-target'</font><font class="font7">])</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font10">return</font><font class="font7"> prob_tmp[</font><font
  class="font11">'woe'</font><font class="font7">].to_dict()</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font10">def</font><font class="font14"> </font><font
  class="font20">integer_encode</font><font class="font14">(</font><font
  class="font7">train</font><font class="font14">,</font><font class="font7">
  test</font><font class="font14">,</font><font class="font7"> variable</font><font
  class="font14">,</font><font class="font7"> ordinal_mapping</font><font
  class="font14">):</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>train[variable] </font><font class="font10">=</font><font class="font7">
  train[variable].map(ordinal_mapping)</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>test[variable] </font><font class="font10">=</font><font class="font7">
  test[variable].map(ordinal_mapping)</font><font class="font7"><br>
    </font></td>
  <td class=xl68 width=745 style='border-top:none;border-left:none;width:559pt'>NA</td>
  <td class=xl68 width=763 style='border-top:none;border-left:none;width:572pt'><font
  class="font10">from</font><font class="font7"> feature_engine.encoding </font><font
  class="font10">import</font><font class="font7"> WoEEncoder </font><font
  class="font10">as</font><font class="font7"> fe_WoEEncoder</font><font
  class="font7"><br>
    </font><font class="font10">from</font><font class="font7">
  category_encoders.woe </font><font class="font10">import</font><font
  class="font7"> WOEEncoder</font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7">woe_enc </font><font class="font10">=</font><font
  class="font7"> fe_WoEEncoder(</font><font class="font12">variables</font><font
  class="font10">=</font><font class="font7">[</font><font class="font11">'cabin'</font><font
  class="font7">, </font><font class="font11">'sex'</font><font class="font7">,
  </font><font class="font11">'embarked'</font><font class="font7">]) woe_enc.fit(X_train,
  y_train)</font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7">woe_enc </font><font class="font10">=</font><font
  class="font7"> WOEEncoder(</font><font class="font12">cols</font><font
  class="font10">=</font><font class="font7">[</font><font class="font11">'cabin'</font><font
  class="font7">, </font><font class="font11">'sex'</font><font class="font7">,
  </font><font class="font11">'embarked'</font><font class="font7">])</font><font
  class="font7"><br>
    </font><font class="font7">woe_enc.fit(X_train, y_train)</font><font
  class="font7"><br>
    </font></td>
 </tr>
 <tr height=325 style='mso-height-source:userset;height:244.5pt'>
  <td height=325 class=xl66 width=148 style='height:244.5pt;border-top:none;
  width:111pt'>Rare Label Encoding</td>
  <td class=xl66 width=285 style='border-top:none;border-left:none;width:214pt'><font
  class="font0">Giá trị hiếm là các hạng mục trong một biến hạng mục chỉ xuất
  hiện trong tỷ lệ nhỏ các quan sát. Không có quy tắc chung nào để xác định thế
  nào là tỷ lệ phần trăm nhỏ, nhưng thông thường, bất kỳ giá trị nào dưới 5%
  đều có thể coi là hiếm.</font><font class="font0"><br>
    </font><font class="font0"><br>
    </font><font class="font0">Scenario for re-grouping:<br>
    </font><font class="font0">- Một hạng mục nổi bật</font><font class="font0"><br>
    </font><font class="font0">- Ít hạng mục</font><font class="font0"><br>
    </font><font class="font0">- Cardinality cao</font><font class="font0"><br>
    </font><font class="font0"><br>
    </font></td>
  <td class=xl66 width=247 style='border-top:none;border-left:none;width:185pt'><font
  class="font0">- Việc nhóm các hạng mục vào 'Rare' với các biến hiển thị
  cardinalty thấp có thể hoặc không thể cải thiện chất lượng mô hình; tuy
  nhiên, chúng ta thường nhóm lại chúng thành một hạng mục mới để triển khai mô
  hình trơn tru.</font><font class="font0"><br>
    </font><font class="font0"><br>
    </font><font class="font0">- Việc nhóm các hạng mục vào 'Rare' với các biến
  có cardinalty cao cũng có xu hướng cải thiện chất lượng của mô hình.</font><font
  class="font0"><br>
    </font><font class="font0"><br>
    </font><font class="font0"><br>
    </font></td>
  <td class=xl64 width=228 style='border-top:none;border-left:none;width:171pt'>&nbsp;</td>
  <td class=xl66 width=299 style='border-top:none;border-left:none;width:224pt'><font
  class="font5">Lưu ý</font><font class="font0"> rằng việc nhóm các nhãn hoặc
  hạng mục không thường xuất hiện vào một hạng mục mới là 'Rare' hoặc 'Other'
  là phương pháp phổ biến trong học máy dành cho doanh nghiệp.</font><font
  class="font6"><br>
    </font><font class="font0"><br>
    </font><font class="font0">• Tất cả phân tích về nhãn nào là nhãn hiếm hay
  không hiếm đều được phân tích trên tập training</font></td>
  <td class=xl66 width=640 style='border-top:none;border-left:none;width:480pt'><font
  class="font10">def</font><font class="font14"> </font><font class="font7">find_non_rare_labels</font><font
  class="font14">(</font><font class="font12">df</font><font class="font14">,</font><font
  class="font12"> variable</font><font class="font14">,</font><font
  class="font12"> tolerance</font><font class="font14">):</font><font
  class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span>temp </font><font
  class="font10">=</font><font class="font7">
  df.groupby([variable])[variable].count() </font><font class="font10">/</font><font
  class="font7"> </font><font class="font19">len</font><font class="font7">(df)</font><font
  class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>non_rare </font><font class="font10">=</font><font class="font7"> [x </font><font
  class="font10">for</font><font class="font7"> x </font><font class="font10">in</font><font
  class="font7"> temp.loc[temp</font><font class="font10">&gt;</font><font
  class="font7">tolerance].index.values]</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font10">return</font><font class="font7"> non_rare</font><font
  class="font7"><br>
    </font><font class="font7"> </font><font class="font10">def</font><font
  class="font7"> rare_encoding(</font><font class="font12">X_train</font><font
  class="font7">,</font><font class="font12"> X_test</font><font class="font7">,</font><font
  class="font12"> variable</font><font class="font7">,</font><font
  class="font12"> tolerance</font><font class="font7">):</font><font
  class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>X_train </font><font class="font10">=</font><font class="font7">
  X_train.copy()</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span>X_test
  </font><font class="font10">=</font><font class="font7"> X_test.copy()</font><font
  class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># tìm hạng mục thường xuất hiện nhất</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>frequent_cat </font><font class="font10">=</font><font class="font7">
  find_non_rare_labels(X_train, variable, tolerance)</font><font class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font8"># nhóm lại các nhãn hiếm</font><font class="font14"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>X_train[variable] </font><font class="font10">=</font><font
  class="font7"> np.where(X_train[variable].isin(</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>       
  </span>frequent_cat), X_train[variable], </font><font class="font11">'Rare'</font><font
  class="font7">)</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>   
  </span>X_test[variable] </font><font class="font10">=</font><font
  class="font7"> np.where(X_test[variable].isin(</font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>       
  </span>frequent_cat), X_test[variable], </font><font class="font11">'Rare'</font><font
  class="font7">)</font><font class="font7"><br>
    </font><font class="font7"><br>
    </font><font class="font7"><span style='mso-spacerun:yes'>    </span></font><font
  class="font10">return</font><font class="font7"> X_train, X_test</font><font
  class="font7"><br>
    </font></td>
  <td class=xl66 width=745 style='border-top:none;border-left:none;width:559pt'>NA</td>
  <td class=xl66 width=763 style='border-top:none;border-left:none;width:572pt'><font
  class="font10">from</font><font class="font7"> feature_engine.encoding </font><font
  class="font10">import</font><font class="font7"> RareLabelEncoder</font><font
  class="font7"> </font><font class="font7">rare_encoder </font><font
  class="font10">=</font><font class="font7"> RareLabelEncoder(</font><font
  class="font7"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">tol</font><font class="font10">=</font><font class="font12">0.05</font><font
  class="font14">,<span style='mso-spacerun:yes'>  </span></font><font
  class="font8"># % tối thiểu được coi là không hiếm</font><font class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">n_categories</font><font class="font10">=</font><font
  class="font12">4</font><font class="font14">, </font><font class="font8"># số
  lượng hạng mục tối thiểu mà biến có để nhóm lại thành các hạng mục chiếm</font><font
  class="font14"><br>
    </font><font class="font14"><span style='mso-spacerun:yes'>    </span></font><font
  class="font12">variables</font><font class="font10">=</font><font
  class="font14">[</font><font class="font7">'Neighborhood'</font><font
  class="font14">, </font><font class="font7">'Exterior1st'</font><font
  class="font14">, </font><font class="font7">'Exterior2nd'</font><font
  class="font14">,</font><font class="font14"><br>
    </font><font class="font9"><span style='mso-spacerun:yes'>              
  </span></font><font class="font17">'MasVnrType'</font><font class="font9">, </font><font
  class="font17">'ExterQual'</font><font class="font9">, </font><font
  class="font17">'BsmtCond'</font><font class="font9">] </font><font
  class="font8"># các biến để nhóm lại</font><font class="font9"><br>
    </font><font class="font7">)<span style='mso-spacerun:yes'>  </span></font><font
  class="font7"><br>
    </font><font class="font7">rare_encoder.fit(X_train.fillna(</font><font
  class="font11">'Missing'</font><font class="font7">))</font><font
  class="font7"><br>
    </font><font class="font7">X_train </font><font class="font10">=</font><font
  class="font7"> rare_encoder.transform(X_train.fillna(</font><font
  class="font11">'Missing'</font><font class="font7">))</font><font
  class="font7"><br>
    </font><font class="font7">X_test </font><font class="font10">=</font><font
  class="font7"> rare_encoder.transform(X_test.fillna(</font><font
  class="font11">'Missing'</font><font class="font7">))</font><font
  class="font7"><br>
    </font></td>
 </tr>
 <![if supportMisalignedColumns]>
 <tr height=0 style='display:none'>
  <td width=148 style='width:111pt'></td>
  <td width=285 style='width:214pt'></td>
  <td width=247 style='width:185pt'></td>
  <td width=228 style='width:171pt'></td>
  <td width=299 style='width:224pt'></td>
  <td width=640 style='width:480pt'></td>
  <td width=745 style='width:559pt'></td>
  <td width=763 style='width:572pt'></td>
 </tr>
 <![endif]>
</table>

</div>


<!----------------------------->
<!--END OF OUTPUT FROM EXCEL PUBLISH AS WEB PAGE WIZARD-->
<!----------------------------->
</body>

</html>
